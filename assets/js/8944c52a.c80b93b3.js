"use strict";(self.webpackChunksearch_party_lab=self.webpackChunksearch_party_lab||[]).push([[4929],{4963:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>d,contentTitle:()=>c,default:()=>g,frontMatter:()=>s,metadata:()=>l,toc:()=>u});var n=t(4848),r=t(8453),o=t(1470),i=t(9365);const s={},c="Using Voyage AI",l={id:"vector-search/create-vectors/ws-voyageai",title:"Using Voyage AI",description:"Take-home activity! Do it if you are following along at home. It won't be covered during the hands-on lab.",source:"@site/docs/7-vector-search/5-create-vectors/4-ws-voyageai.mdx",sourceDirName:"7-vector-search/5-create-vectors",slug:"/vector-search/create-vectors/ws-voyageai",permalink:"/search-lab/docs/vector-search/create-vectors/ws-voyageai",draft:!1,unlisted:!1,editUrl:"https://github.com/mongodb-developer/search-lab/blob/main/docs/7-vector-search/5-create-vectors/4-ws-voyageai.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Using Amazon SageMaker",permalink:"/search-lab/docs/vector-search/create-vectors/ws-sagemaker"},next:{title:"Hybrid Search",permalink:"/search-lab/docs/category/hybrid-search"}},d={},u=[{value:"Create a Voyage account and get an API key",id:"create-a-voyage-account-and-get-an-api-key",level:2},{value:"Create embeddings with cURL",id:"create-embeddings-with-curl",level:2},{value:"Using Voyage AI in the application",id:"using-voyage-ai-in-the-application",level:2},{value:"Configuring the application",id:"configuring-the-application",level:2},{value:"Running the application",id:"running-the-application",level:2}];function h(e){const a={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components},{Screenshot:t}=a;return t||function(e,a){throw new Error("Expected "+(a?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Screenshot",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.header,{children:(0,n.jsx)(a.h1,{id:"using-voyage-ai",children:"Using Voyage AI"})}),"\n",(0,n.jsx)(a.admonition,{type:"info",children:(0,n.jsx)(a.p,{children:"Take-home activity! Do it if you are following along at home. It won't be covered during the hands-on lab."})}),"\n",(0,n.jsx)(a.p,{children:"Voyage AI provides high\u2011quality embedding models you can use for semantic search. You\u2019ll need an API key to call their Embeddings API."}),"\n",(0,n.jsx)(a.h2,{id:"create-a-voyage-account-and-get-an-api-key",children:"Create a Voyage account and get an API key"}),"\n",(0,n.jsxs)(a.p,{children:["To get started with Voyage AI, go to ",(0,n.jsx)(a.a,{href:"https://voyageai.com",children:"https://voyageai.com"})," and create an account."]}),"\n",(0,n.jsx)(t,{src:"img/screenshots/7-vector-search/5-create-vectors/5-voyage/1-create-account.png",url:"https://www.voyageai.com/",alt:"The Voyage AI page"}),"\n",(0,n.jsx)(a.p,{children:"Once you\u2019re logged in, navigate to your account dashboard and generate a new API key."}),"\n",(0,n.jsx)(t,{src:"img/screenshots/7-vector-search/5-create-vectors/5-voyage/2-create-key.png",url:"https://dashboard.voyageai.com/organization/api-keys",alt:"The Voyage AI API keys page"}),"\n",(0,n.jsx)(a.p,{children:"This key will be required to call the Voyage Embeddings API. Make sure you copy and store it in a safe place, as you\u2019ll need it later when configuring the application."}),"\n",(0,n.jsx)(t,{src:"img/screenshots/7-vector-search/5-create-vectors/5-voyage/3-store-api-key.png",url:"https://dashboard.voyageai.com/organization/api-keys",alt:"The Voyage AI API keys page"}),"\n",(0,n.jsx)(a.h2,{id:"create-embeddings-with-curl",children:"Create embeddings with cURL"}),"\n",(0,n.jsxs)(a.p,{children:["Once you have your API key, you can test the API directly using ",(0,n.jsx)(a.code,{children:"curl"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:'VOYAGE_API_KEY=<YOUR_API_KEY>\n\ncurl --location \'https://api.voyageai.com/v1/embeddings\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Authorization: Bearer $VOYAGE_API_KEY\' \\\n--data \'{ \n    "input": "Some text ..",\n    "model": "voyage-3-large",    \n    "output_dimension": 2048\n}\'\n'})}),"\n",(0,n.jsx)(a.h2,{id:"using-voyage-ai-in-the-application",children:"Using Voyage AI in the application"}),"\n",(0,n.jsx)(o.A,{groupId:"server",children:(0,n.jsxs)(i.A,{value:"java",label:"\u2615\ufe0f Java Spring Boot",children:[(0,n.jsxs)(a.p,{children:["To run semantic queries in Java, the application also needs to generate embeddings for your query.",(0,n.jsx)(a.br,{}),"\n","This is handled by the ",(0,n.jsx)(a.a,{href:"https://github.com/mongodb-developer/library-management-system/blob/java-server/java-server/src/main/java/com/mongodb/devrel/library/domain/provider/EmbeddingProvider.java",children:(0,n.jsx)(a.code,{children:"EmbeddingProvider"})})," interface."]}),(0,n.jsxs)(a.p,{children:["For Voyage AI, the implementation is ",(0,n.jsx)(a.a,{href:"https://github.com/mongodb-developer/library-management-system/blob/java-server/java-server/src/main/java/com/mongodb/devrel/library/infrastructure/provider/VoyageAIEmbeddingProvider.java",children:(0,n.jsx)(a.code,{children:"VoyageAIEmbeddingProvider"})}),", which delegates the HTTP call to the Feign client:"]}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",metastring:"title='src/main/java/com/mongodb/devrel/library/infrastructure/embeddings/voyageai/VoyageEmbeddingsClient.java'",children:'@FeignClient(\n        name = "voyage",\n        url = "${voyage.base-url}",\n        configuration = VoyageFeignInterceptor.class\n)\npublic interface VoyageEmbeddingsClient {\n  @PostMapping("/embeddings")\n  VoyageEmbeddingsResponse getEmbeddings(@RequestBody VoyageEmbeddingsRequest body);\n}\n'})}),(0,n.jsx)(a.h2,{id:"configuring-the-application",children:"Configuring the application"}),(0,n.jsxs)(a.p,{children:["To use Voyage AI, you only need to adjust a few parameters in ",(0,n.jsx)(a.code,{children:"application.yml"}),":"]}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-yml",metastring:"title='src/main/resources/application.yml'",children:"embeddings:\n  source: ${EMBEDDING_SOURCE}\nvoyage:\n  api-key: ${VOYAGE_KEY:yourKey}\n"})}),(0,n.jsxs)(a.p,{children:["The ",(0,n.jsx)(a.code,{children:"embeddings.source"})," property is what selects the provider at runtime.\nIf you set it to ",(0,n.jsx)(a.code,{children:"voyage"}),", the Voyage AI implementation will be used. You can either edit these values in ",(0,n.jsx)(a.code,{children:"application.yml"}),", or export them as environment variables:"]}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"export EMBEDDING_SOURCE=voyage\nexport VOYAGE_KEY=pa-6r..\n"})}),(0,n.jsx)(a.h2,{id:"running-the-application",children:"Running the application"}),(0,n.jsx)(a.p,{children:"Once the variables are set, start the application as usual:"}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"mvn spring-boot:run\n"})}),(0,n.jsxs)(a.p,{children:["At the end, when the application starts, just make a call to ",(0,n.jsx)(a.code,{children:"searchBooks"})," as\ndescribed in the step ",(0,n.jsx)(a.a,{href:"http://localhost:3000/search-lab/docs/vector-search/add-to-app",children:"Add Semantic Search to Your Application"}),"\nand you will see the application calling the ",(0,n.jsx)(a.strong,{children:"Voyage AI"})," implementation:"]}),(0,n.jsx)(t,{src:"/img/screenshots/7-vector-search/5-create-vectors/5-voyage/4-checking-logs.png",url:"https://cloud.google.com"})]})})]})}function g(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},9365:(e,a,t)=>{t.d(a,{A:()=>i});t(6540);var n=t(8215);const r={tabItem:"tabItem_Ymn6"};var o=t(4848);function i(e){let{children:a,hidden:t,className:i}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,n.A)(r.tabItem,i),hidden:t,children:a})}},1470:(e,a,t)=>{t.d(a,{A:()=>I});var n=t(6540),r=t(8215),o=t(3104),i=t(6347),s=t(205),c=t(7485),l=t(1682),d=t(679);function u(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:a}=e;return!!a&&"object"==typeof a&&"value"in a}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:a,children:t}=e;return(0,n.useMemo)((()=>{const e=a??function(e){return u(e).map((e=>{let{props:{value:a,label:t,attributes:n,default:r}}=e;return{value:a,label:t,attributes:n,default:r}}))}(t);return function(e){const a=(0,l.XI)(e,((e,a)=>e.value===a.value));if(a.length>0)throw new Error(`Docusaurus error: Duplicate values "${a.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[a,t])}function g(e){let{value:a,tabValues:t}=e;return t.some((e=>e.value===a))}function p(e){let{queryString:a=!1,groupId:t}=e;const r=(0,i.W6)(),o=function(e){let{queryString:a=!1,groupId:t}=e;if("string"==typeof a)return a;if(!1===a)return null;if(!0===a&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:a,groupId:t});return[(0,c.aZ)(o),(0,n.useCallback)((e=>{if(!o)return;const a=new URLSearchParams(r.location.search);a.set(o,e),r.replace({...r.location,search:a.toString()})}),[o,r])]}function m(e){const{defaultValue:a,queryString:t=!1,groupId:r}=e,o=h(e),[i,c]=(0,n.useState)((()=>function(e){let{defaultValue:a,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!g({value:a,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${a}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return a}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:a,tabValues:o}))),[l,u]=p({queryString:t,groupId:r}),[m,v]=function(e){let{groupId:a}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(a),[r,o]=(0,d.Dv)(t);return[r,(0,n.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:r}),b=(()=>{const e=l??m;return g({value:e,tabValues:o})?e:null})();(0,s.A)((()=>{b&&c(b)}),[b]);return{selectedValue:i,selectValue:(0,n.useCallback)((e=>{if(!g({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),v(e)}),[u,v,o]),tabValues:o}}var v=t(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=t(4848);function f(e){let{className:a,block:t,selectedValue:n,selectValue:i,tabValues:s}=e;const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),d=e=>{const a=e.currentTarget,t=c.indexOf(a),r=s[t].value;r!==n&&(l(a),i(r))},u=e=>{let a=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;a=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;a=c[t]??c[c.length-1];break}}a?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},a),children:s.map((e=>{let{value:a,label:t,attributes:o}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:n===a?0:-1,"aria-selected":n===a,ref:e=>c.push(e),onKeyDown:u,onClick:d,...o,className:(0,r.A)("tabs__item",b.tabItem,o?.className,{"tabs__item--active":n===a}),children:t??a},a)}))})}function j(e){let{lazy:a,children:t,selectedValue:o}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(a){const e=i.find((e=>e.props.value===o));return e?(0,n.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:i.map(((e,a)=>(0,n.cloneElement)(e,{key:a,hidden:e.props.value!==o})))})}function x(e){const a=m(e);return(0,y.jsxs)("div",{className:(0,r.A)("tabs-container",b.tabList),children:[(0,y.jsx)(f,{...a,...e}),(0,y.jsx)(j,{...a,...e})]})}function I(e){const a=(0,v.A)();return(0,y.jsx)(x,{...e,children:u(e.children)},String(a))}},8453:(e,a,t)=>{t.d(a,{R:()=>i,x:()=>s});var n=t(6540);const r={},o=n.createContext(r);function i(e){const a=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function s(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(o.Provider,{value:a},e.children)}}}]);